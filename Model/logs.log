2021-07-24 18:57:57,180:INFO:PyCaret Supervised Module
2021-07-24 18:57:57,181:INFO:ML Usecase: classification
2021-07-24 18:57:57,181:INFO:version 2.3.2
2021-07-24 18:57:57,181:INFO:Initializing setup()
2021-07-24 18:57:57,181:INFO:setup(target=status_group, ml_usecase=classification, available_plots={'parameter': 'Hyperparameters', 'auc': 'AUC', 'confusion_matrix': 'Confusion Matrix', 'threshold': 'Threshold', 'pr': 'Precision Recall', 'error': 'Prediction Error', 'class_report': 'Class Report', 'rfe': 'Feature Selection', 'learning': 'Learning Curve', 'manifold': 'Manifold Learning', 'calibration': 'Calibration Curve', 'vc': 'Validation Curve', 'dimension': 'Dimensions', 'feature': 'Feature Importance', 'feature_all': 'Feature Importance (All)', 'boundary': 'Decision Boundary', 'lift': 'Lift Chart', 'gain': 'Gain Chart', 'tree': 'Decision Tree', 'ks': 'KS Statistic Plot'}, train_size=0.7, test_data=None, preprocess=True, imputation_type=simple, iterative_imputation_iters=5, categorical_features=None, categorical_imputation=constant, categorical_iterative_imputer=lightgbm, ordinal_features=None, high_cardinality_features=None, high_cardinality_method=frequency, numeric_features=None, numeric_imputation=mean, numeric_iterative_imputer=lightgbm, date_features=None, ignore_features=None, normalize=False, normalize_method=zscore, transformation=False, transformation_method=yeo-johnson, handle_unknown_categorical=True, unknown_categorical_method=least_frequent, pca=False, pca_method=linear, pca_components=None, ignore_low_variance=False, combine_rare_levels=False, rare_level_threshold=0.1, bin_numeric_features=None, remove_outliers=False, outliers_threshold=0.05, remove_multicollinearity=False, multicollinearity_threshold=0.9, remove_perfect_collinearity=True, create_clusters=False, cluster_iter=20, polynomial_features=False, polynomial_degree=2, trigonometry_features=False, polynomial_threshold=0.1, group_features=None, group_names=None, feature_selection=False, feature_selection_threshold=0.8, feature_selection_method=classic, feature_interaction=False, feature_ratio=False, interaction_threshold=0.01, fix_imbalance=False, fix_imbalance_method=None, transform_target=False, transform_target_method=box-cox, data_split_shuffle=True, data_split_stratify=False, fold_strategy=stratifiedkfold, fold=10, fold_shuffle=False, fold_groups=None, n_jobs=-1, use_gpu=False, custom_pipeline=None, html=True, session_id=123, log_experiment=True, experiment_name=pump, log_plots=False, log_profile=False, log_data=False, silent=False, verbose=True, profile=False, profile_kwargs=None, display=None)
2021-07-24 18:57:57,181:INFO:Checking environment
2021-07-24 18:57:57,181:INFO:python_version: 3.7.10
2021-07-24 18:57:57,181:INFO:python_build: ('default', 'Feb 19 2021 16:07:37')
2021-07-24 18:57:57,181:INFO:machine: x86_64
2021-07-24 18:57:57,182:INFO:platform: Linux-5.4.0-1035-azure-x86_64-with-debian-buster-sid
2021-07-24 18:57:57,182:INFO:Memory: svmem(total=16791863296, available=10085543936, percent=39.9, used=7119867904, free=514437120, active=9427959808, inactive=4045783040, buffers=2188484608, cached=6969073664, shared=2990080, slab=2652659712)
2021-07-24 18:57:57,184:INFO:Physical Core: 2
2021-07-24 18:57:57,185:INFO:Logical Core: 4
2021-07-24 18:57:57,185:INFO:Checking libraries
2021-07-24 18:57:57,185:INFO:pd==1.3.0
2021-07-24 18:57:57,185:INFO:numpy==1.19.5
2021-07-24 18:57:57,185:INFO:sklearn==0.23.2
2021-07-24 18:57:57,185:INFO:lightgbm==3.2.1
2021-07-24 18:57:57,185:WARNING:catboost not found
2021-07-24 18:57:57,186:WARNING:xgboost not found
2021-07-24 18:57:57,589:INFO:mlflow==1.19.0
2021-07-24 18:57:57,590:INFO:Checking Exceptions
2021-07-24 18:57:57,590:INFO:Declaring global variables
2021-07-24 18:57:57,590:INFO:USI: c1b6
2021-07-24 18:57:57,590:INFO:pycaret_globals: {'create_model_container', 'experiment__', 'y_test', 'y_train', 'pycaret_globals', 'exp_name_log', 'fold_generator', '_all_models', 'X_test', 'master_model_container', 'transform_target_method_param', '_all_metrics', 'html_param', 'fix_imbalance_param', 'transform_target_param', 'fix_imbalance_method_param', 'X_train', 'prep_pipe', 'iterative_imputation_iters_param', '_gpu_n_jobs_param', 'logging_param', 'stratify_param', '_available_plots', 'fold_groups_param_full', 'fold_groups_param', 'data_before_preprocess', 'display_container', 'n_jobs_param', 'log_plots_param', 'seed', 'gpu_param', 'USI', '_all_models_internal', 'imputation_regressor', 'imputation_classifier', 'fold_param', '_internal_pipeline', 'fold_shuffle_param', 'target_param', 'X', 'y', '_ml_usecase'}
2021-07-24 18:57:57,590:INFO:Preparing display monitor
2021-07-24 18:57:57,590:INFO:Preparing display monitor
2021-07-24 18:57:57,609:INFO:Importing libraries
2021-07-24 18:57:57,609:INFO:Copying data for preprocessing
2021-07-24 18:57:57,618:INFO:Declaring preprocessing parameters
2021-07-24 18:57:57,620:INFO:Creating preprocessing pipeline
2021-07-24 18:57:57,635:INFO:Preprocessing pipeline created successfully
2021-07-24 18:57:57,635:ERROR:(Process Exit): setup has been interupted with user command 'quit'. setup must rerun.
2021-07-24 18:57:57,636:INFO:Creating global containers
2021-07-24 18:57:57,637:INFO:Internal pipeline: Pipeline(memory=None, steps=[('empty_step', 'passthrough')], verbose=False)
2021-07-24 18:58:07,387:WARNING:Couldn't import xgboost.XGBClassifier
2021-07-24 18:58:07,387:WARNING:Couldn't import catboost.CatBoostClassifier
2021-07-24 18:58:07,480:WARNING:Couldn't import xgboost.XGBClassifier
2021-07-24 18:58:07,481:WARNING:Couldn't import catboost.CatBoostClassifier
2021-07-24 18:58:07,482:INFO:Creating grid variables
2021-07-24 18:58:07,506:INFO:Logging experiment in MLFlow
2021-07-24 18:58:07,666:INFO:SubProcess save_model() called ==================================
2021-07-24 18:58:07,684:INFO:Initializing save_model()
2021-07-24 18:58:07,684:INFO:save_model(model=Pipeline(memory=None,
         steps=[('dtypes',
                 DataTypes_Auto_infer(categorical_features=[],
                                      display_types=True, features_todrop=[],
                                      id_columns=[],
                                      ml_usecase='classification',
                                      numerical_features=[],
                                      target='status_group',
                                      time_features=[])),
                ('imputer',
                 Simple_Imputer(categorical_strategy='not_available',
                                fill_value_categorical=None,
                                fill_value_numerical=None,
                                numeric...
                ('scaling', 'passthrough'), ('P_transform', 'passthrough'),
                ('binn', 'passthrough'), ('rem_outliers', 'passthrough'),
                ('cluster_all', 'passthrough'),
                ('dummy', Dummify(target='status_group')),
                ('fix_perfect', Remove_100(target='status_group')),
                ('clean_names', Clean_Colum_Names()),
                ('feature_select', 'passthrough'), ('fix_multi', 'passthrough'),
                ('dfs', 'passthrough'), ('pca', 'passthrough')],
         verbose=False), model_name=Transformation Pipeline, prep_pipe_=Pipeline(memory=None,
         steps=[('dtypes',
                 DataTypes_Auto_infer(categorical_features=[],
                                      display_types=True, features_todrop=[],
                                      id_columns=[],
                                      ml_usecase='classification',
                                      numerical_features=[],
                                      target='status_group',
                                      time_features=[])),
                ('imputer',
                 Simple_Imputer(categorical_strategy='not_available',
                                fill_value_categorical=None,
                                fill_value_numerical=None,
                                numeric...
                ('scaling', 'passthrough'), ('P_transform', 'passthrough'),
                ('binn', 'passthrough'), ('rem_outliers', 'passthrough'),
                ('cluster_all', 'passthrough'),
                ('dummy', Dummify(target='status_group')),
                ('fix_perfect', Remove_100(target='status_group')),
                ('clean_names', Clean_Colum_Names()),
                ('feature_select', 'passthrough'), ('fix_multi', 'passthrough'),
                ('dfs', 'passthrough'), ('pca', 'passthrough')],
         verbose=False), verbose=False, kwargs={})
2021-07-24 18:58:07,684:INFO:Adding model into prep_pipe
2021-07-24 18:58:07,689:WARNING:Only Model saved as it was a pipeline.
2021-07-24 18:58:07,703:INFO:Transformation Pipeline.pkl saved in current working directory
2021-07-24 18:58:07,710:INFO:Pipeline(memory=None,
         steps=[('dtypes',
                 DataTypes_Auto_infer(categorical_features=[],
                                      display_types=True, features_todrop=[],
                                      id_columns=[],
                                      ml_usecase='classification',
                                      numerical_features=[],
                                      target='status_group',
                                      time_features=[])),
                ('imputer',
                 Simple_Imputer(categorical_strategy='not_available',
                                fill_value_categorical=None,
                                fill_value_numerical=None,
                                numeric...
                ('scaling', 'passthrough'), ('P_transform', 'passthrough'),
                ('binn', 'passthrough'), ('rem_outliers', 'passthrough'),
                ('cluster_all', 'passthrough'),
                ('dummy', Dummify(target='status_group')),
                ('fix_perfect', Remove_100(target='status_group')),
                ('clean_names', Clean_Colum_Names()),
                ('feature_select', 'passthrough'), ('fix_multi', 'passthrough'),
                ('dfs', 'passthrough'), ('pca', 'passthrough')],
         verbose=False)
2021-07-24 18:58:07,710:INFO:save_model() successfully completed......................................
2021-07-24 18:58:07,987:INFO:SubProcess save_model() end ==================================
2021-07-24 18:58:07,996:INFO:create_model_container: 0
2021-07-24 18:58:07,996:INFO:master_model_container: 0
2021-07-24 18:58:07,996:INFO:display_container: 1
2021-07-24 18:58:08,001:INFO:Pipeline(memory=None,
         steps=[('dtypes',
                 DataTypes_Auto_infer(categorical_features=[],
                                      display_types=True, features_todrop=[],
                                      id_columns=[],
                                      ml_usecase='classification',
                                      numerical_features=[],
                                      target='status_group',
                                      time_features=[])),
                ('imputer',
                 Simple_Imputer(categorical_strategy='not_available',
                                fill_value_categorical=None,
                                fill_value_numerical=None,
                                numeric...
                ('scaling', 'passthrough'), ('P_transform', 'passthrough'),
                ('binn', 'passthrough'), ('rem_outliers', 'passthrough'),
                ('cluster_all', 'passthrough'),
                ('dummy', Dummify(target='status_group')),
                ('fix_perfect', Remove_100(target='status_group')),
                ('clean_names', Clean_Colum_Names()),
                ('feature_select', 'passthrough'), ('fix_multi', 'passthrough'),
                ('dfs', 'passthrough'), ('pca', 'passthrough')],
         verbose=False)
2021-07-24 18:58:08,001:INFO:setup() succesfully completed......................................
2021-07-24 18:58:08,259:INFO:Initializing compare_models()
2021-07-24 18:58:08,260:INFO:compare_models(include=None, fold=None, round=4, cross_validation=True, sort=Accuracy, n_select=1, budget_time=None, turbo=True, errors=ignore, fit_kwargs=None, groups=None, verbose=True, display=None, exclude=None)
2021-07-24 18:58:08,260:INFO:Checking exceptions
2021-07-24 18:58:08,261:INFO:Preparing display monitor
2021-07-24 18:58:08,262:INFO:Preparing display monitor
2021-07-24 18:58:08,303:INFO:Initializing Logistic Regression
2021-07-24 18:58:08,303:INFO:Total runtime is 3.1709671020507814e-06 minutes
2021-07-24 18:58:08,315:INFO:SubProcess create_model() called ==================================
2021-07-24 18:58:08,315:INFO:Initializing create_model()
2021-07-24 18:58:08,315:INFO:create_model(estimator=lr, fold=StratifiedKFold(n_splits=10, random_state=None, shuffle=False), round=4, cross_validation=True, predict=True, fit_kwargs={}, groups=None, refit=False, verbose=False, system=False, metrics=None, display=<pycaret.internal.Display.Display object at 0x7fee7c69a850>, kwargs={})
2021-07-24 18:58:08,315:INFO:Checking exceptions
2021-07-24 18:58:08,315:INFO:Importing libraries
2021-07-24 18:58:08,315:INFO:Copying training dataset
2021-07-24 18:58:08,317:INFO:Defining folds
2021-07-24 18:58:08,317:INFO:Declaring metric variables
2021-07-24 18:58:08,349:INFO:Importing untrained model
2021-07-24 18:58:08,359:INFO:Logistic Regression Imported succesfully
2021-07-24 18:58:08,378:INFO:Starting cross validation
2021-07-24 18:58:08,379:INFO:Cross validating with StratifiedKFold(n_splits=10, random_state=None, shuffle=False), n_jobs=-1
2021-07-24 18:58:51,553:WARNING:create_model() for lr raised an exception or returned all 0.0, trying without fit_kwargs:
2021-07-24 18:58:51,570:WARNING:Traceback (most recent call last):
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/pycaret/internal/tabular.py", line 2176, in compare_models
    refit=False,
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/pycaret/internal/tabular.py", line 3125, in create_model_supervised
    error_score=0,
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/sklearn/utils/validation.py", line 72, in inner_f
    return f(**kwargs)
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/sklearn/model_selection/_validation.py", line 248, in cross_validate
    for train, test in cv.split(X, y, groups))
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/joblib/parallel.py", line 1044, in __call__
    while self.dispatch_one_batch(iterator):
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/joblib/parallel.py", line 859, in dispatch_one_batch
    self._dispatch(tasks)
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/joblib/parallel.py", line 777, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/joblib/_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/joblib/_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/joblib/parallel.py", line 263, in __call__
    for func, args, kwargs in self.items]
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/joblib/parallel.py", line 263, in <listcomp>
    for func, args, kwargs in self.items]
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/sklearn/model_selection/_validation.py", line 531, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/pycaret/internal/pipeline.py", line 118, in fit
    result = super().fit(X, y=y, **fit_kwargs)
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/imblearn/pipeline.py", line 281, in fit
    self._final_estimator.fit(Xt, yt, **fit_params)
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/sklearn/linear_model/_logistic.py", line 1417, in fit
    for class_, warm_start_coef_ in zip(classes_, warm_start_coef))
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/joblib/parallel.py", line 1041, in __call__
    if self.dispatch_one_batch(iterator):
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/joblib/parallel.py", line 859, in dispatch_one_batch
    self._dispatch(tasks)
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/joblib/parallel.py", line 777, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/joblib/_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/joblib/_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/joblib/parallel.py", line 263, in __call__
    for func, args, kwargs in self.items]
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/joblib/parallel.py", line 263, in <listcomp>
    for func, args, kwargs in self.items]
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/sklearn/linear_model/_logistic.py", line 760, in _logistic_regression_path
    options={"iprint": iprint, "gtol": tol, "maxiter": max_iter}
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/scipy/optimize/_minimize.py", line 618, in minimize
    callback=callback, **options)
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/scipy/optimize/lbfgsb.py", line 360, in _minimize_lbfgsb
    f, g = func_and_grad(x)
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/scipy/optimize/_differentiable_functions.py", line 200, in fun_and_grad
    self._update_fun()
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/scipy/optimize/_differentiable_functions.py", line 166, in _update_fun
    self._update_fun_impl()
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/scipy/optimize/_differentiable_functions.py", line 73, in update_fun
    self.f = fun_wrapped(self.x)
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/scipy/optimize/_differentiable_functions.py", line 70, in fun_wrapped
    return fun(x, *args)
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/scipy/optimize/optimize.py", line 74, in __call__
    self._compute_if_needed(x, *args)
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/scipy/optimize/optimize.py", line 68, in _compute_if_needed
    fg = self.fun(x, *args)
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/sklearn/linear_model/_logistic.py", line 735, in func
    def func(x, *args): return _multinomial_loss_grad(x, *args)[0:2]
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/sklearn/linear_model/_logistic.py", line 347, in _multinomial_loss_grad
    loss, p, w = _multinomial_loss(w, X, Y, alpha, sample_weight)
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/sklearn/linear_model/_logistic.py", line 295, in _multinomial_loss
    p = safe_sparse_dot(X, w.T)
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/sklearn/utils/validation.py", line 72, in inner_f
    return f(**kwargs)
  File "/srv/conda/envs/notebook/lib/python3.7/site-packages/sklearn/utils/extmath.py", line 153, in safe_sparse_dot
    ret = a @ b
KeyboardInterrupt

2021-07-24 18:58:51,570:INFO:Initializing create_model()
2021-07-24 18:58:51,570:INFO:create_model(estimator=lr, fold=StratifiedKFold(n_splits=10, random_state=None, shuffle=False), round=4, cross_validation=True, predict=True, fit_kwargs=None, groups=None, refit=False, verbose=False, system=False, metrics=None, display=<pycaret.internal.Display.Display object at 0x7fee7c69a850>, kwargs={})
2021-07-24 18:58:51,570:INFO:Checking exceptions
2021-07-24 18:58:51,570:INFO:Importing libraries
2021-07-24 18:58:51,570:INFO:Copying training dataset
2021-07-24 18:58:51,573:INFO:Defining folds
2021-07-24 18:58:51,573:INFO:Declaring metric variables
2021-07-24 18:58:51,596:INFO:Importing untrained model
2021-07-24 18:58:51,610:INFO:Logistic Regression Imported succesfully
2021-07-24 18:58:51,664:INFO:Starting cross validation
2021-07-24 18:58:51,665:INFO:Cross validating with StratifiedKFold(n_splits=10, random_state=None, shuffle=False), n_jobs=-1
